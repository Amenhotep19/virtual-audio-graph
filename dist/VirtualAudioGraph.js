"use strict";function _classCallCheck(e,i){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,i){for(var r=0;r<i.length;r++){var o=i[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(i,r,o){return r&&e(i.prototype,r),o&&e(i,o),i}}(),_require=require("ramda"),concat=_require.concat,differenceWith=_require.differenceWith,eqProps=_require.eqProps,find=_require.find,findIndex=_require.findIndex,forEach=_require.forEach,intersectionWith=_require.intersectionWith,map=_require.map,prop=_require.prop,propEq=_require.propEq,remove=_require.remove,VirtualAudioNode=require("./VirtualAudioNode"),VirtualAudioGraph=function(){function e(){var i=void 0===arguments[0]?{}:arguments[0];_classCallCheck(this,e),Object.assign(this,{audioContext:i.audioContext,destination:i.destination,virtualAudioGraph:[]})}return _createClass(e,[{key:"connectAudioNodes",value:function(){var e=this;return forEach(function(i){var r=i.audioNode,o=i.connections;forEach(function(i){r.connect(0===i?e.destination:prop("audioNode",find(propEq("id",i))(e.virtualAudioGraph)))},o)},this.virtualAudioGraph),this}},{key:"createAudioNode",value:function(e){return new VirtualAudioNode(this.audioContext,e)}},{key:"createAudioNodes",value:function(e){return this.virtualAudioGraph=concat(this.virtualAudioGraph,map(this.createAudioNode.bind(this),e)),this}},{key:"removeAudioNodes",value:function(e){var i=this;return forEach(function(e){var r=e.audioNode,o=e.id;r.stop&&r.stop(),r.disconnect(),i.virtualAudioGraph=remove(findIndex(propEq("id",o))(i.virtualAudioGraph),1,i.virtualAudioGraph)},e),this}},{key:"update",value:function(e){var i=differenceWith(eqProps("id"),e,this.virtualAudioGraph),r=differenceWith(eqProps("id"),this.virtualAudioGraph,e),o=intersectionWith(eqProps("id"),e,this.virtualAudioGraph);return this.removeAudioNodes(r).updateAudioNodes(o).createAudioNodes(i).connectAudioNodes()}},{key:"updateAudioNodes",value:function(e){var i=this;return forEach(function(e){var r=find(propEq("id",e.id))(i.virtualAudioGraph);r.updateAudioNode(e.params)},e),this}}]),e}();module.exports=VirtualAudioGraph;